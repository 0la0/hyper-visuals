<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PS-Markup Example</title>
    <style>
      html, body {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        background-color: #242424;
        color: #CCC;
        font-family: helvetica, arial, sans-serif;
        font-size: 12px;
        overflow: hidden;
      }
      .toggle-button {
        position: absolute;
        right: 0;
        top: 0;
        padding: 8px;
        margin: 8px;
        background: unset;
        color: #CCC;
        border: 2px solid #CCC;
        border-radius: 4px;
        cursor: pointer;
      }
    </style>
    <script src="./ps-pattern/dist/pspattern.js"></script>
    <script src="./psvisuals.js"></script>
    <script>
      let isOn = false;
      function toggle() {
        isOn = !isOn;
        const scene = document.getElementById('scene');
        isOn ? scene.start() : scene.stop();
      }
      window.addEventListener('resize', () => {
        document.getElementById('scene').setSize(
          window.innerWidth,
          window.innerHeight
        );
      });
    </script>
  </head>
  <body>
    <button class="toggle-button" onclick="toggle(event)">toggle</button>

    <ps-seq>
      <ps-pat-midi pattern="a:1 a:2 , a:3"></ps-pat-midi>
      <ps-pat-midi pattern="a:1 a:2 a:3"></ps-pat-midi>
    </ps-seq>

    <ps-viz-scene embed id="scene">
      <ps-viz-cone
        position="fn(10*saw(time)) -10 0"
        rotation="addr(a)"
        scale="1 1 1"
        color="0.5 0 0.8"
      >
      </ps-viz-cone>
      <ps-viz-plane
        position="fn(10*sin(time)) -10 0"
        rotation="fn(time*0.25) fn(time) fn(time*0.125)"
        scale="1 1 1"
        color="0.5 0 0.8"
      >
      </ps-viz-plane>
      <ps-viz-ring
        position="10 10 0"
        rotation="fn(time*0.125) 0 fn(time*0.125)"
        scale="4"
        color="0 0 1"
      >
      </ps-viz-ring>
      <!-- <ps-viz-repeat
        repeat="30 30 10"
        stride="4 3 4"
        pos-mod="mod(40*squ(0.00001*time*y)) mod(20*sin(0.0001*time*z)) 0"
        rot-mod="mod(10*sin(0.000001*time*y*z)) 0 0"
        scale-mod="mod(sin(time*0.0001*x)) 0 0"
        color-mod="mod(sin(0.00001*time*y)) mod(cos(0.0005*time*x)) mod(squ(0.0001*time))"
      >
        <ps-viz-triangle
          scale="0.2"
          color="1 1 1"
          position="0 0 0"
          rotation="fn(0.0*time)"
        >
        </ps-viz-triangle>
      </ps-viz-repeat> -->
      <ps-viz-light
        position="fn(50*sin(time)) fn(50*cos(0.5*time)) fn(80*cos(0.25*time))"
        color="1 1 1"
      >
      </ps-viz-light>
      <ps-viz-background
        color="0 0 0"
        light-color="1 1 1"
        light-intensity="0.5"
      >
      </ps-viz-background>
      <ps-viz-camera
        position="0 0 100"
        rotation="0 0 0"
      >
      </ps-viz-camera>
      <ps-viz-filter-pixelate
        amount="fn(20*sin(0.5*time)+20)"
      >
      </ps-viz-filter-pixelate>
      <!-- <ps-viz-filter-cloud
        amplitude="0.2"
        frequency="0.00001"
      >
      </ps-viz-filter-cloud> -->
      <!-- <ps-viz-filter-oscillate
        amplitude="0.05"
        frequency="0.005"
        period="5"
        rotation="fn(-2.5*time)"
        type="saw"
      >
      </ps-viz-filter-oscillate> -->
      <!-- <ps-viz-filter-oscillate
        amplitude="0.05"
        frequency="0.005"
        period="10"
        rotation="fn(5*time)"
        type="sin"
      >
      </ps-viz-filter-oscillate> -->
      <ps-viz-filter-afterimage>
      </ps-viz-filter-afterimage>
    </ps-viz-scene>
  </body>  
</html>
